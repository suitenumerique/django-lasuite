"""Module containing utility functions for the malware detection service."""

from functools import lru_cache

from cryptography.fernet import Fernet
from django.conf import settings


@lru_cache(maxsize=1)
def get_cipher_suite():
    """Return a Fernet cipher suite."""
    return Fernet(settings.MALWARE_DETECTION_ENCRYPTION_KEY)


def encrypt_message(message: str) -> str:
    """Encrypt a message using the cipher suite."""
    fernet = get_cipher_suite()
    return fernet.encrypt(message.encode()).decode()


def decrypt_message(message: str) -> str:
    """Decrypt a message using the cipher suite."""
    fernet = get_cipher_suite()
    return fernet.decrypt(message.encode()).decode()
