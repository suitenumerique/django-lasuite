"""Test malware_detection dummy backend."""

from unittest.mock import MagicMock

from lasuite.malware_detection.backends.dummy import DummyBackend
from lasuite.malware_detection.enums import ReportStatus

dummy_callback = MagicMock()


def test_dummy_backend():
    """Assert the dummy backend calls the callback with safe status and the correct kwargs."""
    backend = DummyBackend(callback_path="tests.malware_detection.backends.test_dummy_backend.dummy_callback")
    backend.analyse_file("foo.txt", foo="bar")

    dummy_callback.assert_called_once_with("foo.txt", ReportStatus.SAFE, error_info={}, foo="bar")
