"""Test the malware detection lazy handler."""

from lasuite.malware_detection import malware_detection
from lasuite.malware_detection.backends.dummy import DummyBackend


def test_malware_detection_lazy_handler(settings):
    """Test the malware detection lazy handler."""
    settings.MALWARE_DETECTION = {
        "BACKEND": "lasuite.malware_detection.backends.dummy.DummyBackend",
        "PARAMETERS": {
            "callback_path": "tests.malware_detection.backends.test_dummy_backend.dummy_callback",
        },
    }
    assert isinstance(malware_detection, DummyBackend)
    assert malware_detection.callback_path == "tests.malware_detection.backends.test_dummy_backend.dummy_callback"
